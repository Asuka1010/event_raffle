{% extends 'raffle/base.html' %}
{% block title %}Edit Historical Database{% endblock %}
{% block content %}
<div class="header">
  <h1>Edit Historical Database</h1>
  <p>Modify student data using the table below</p>
  <div class="help-text">You can change Name, Class, Attended, Absent, Late, Latest Attended, and Attended Events.</div>
  <div class="help-text">Event1..EventN columns are preserved automatically.</div>
</div>

<div class="card">
  <div class="card-content">
    <form method="post">
      {% csrf_token %}
      <input type="hidden" name="row_count" value="{{ row_count }}" />
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Email</th>
              <th>First Name</th>
              <th>Last Name</th>
              <th>Class</th>
              <th>Attended</th>
              <th>Absent</th>
              <th>Late</th>
              <th>Latest Attended</th>
              <th>Attended Events</th>
            </tr>
          </thead>
          <tbody>
            {% for r in rows %}
            <tr>
              <td><input type="email" name="email_{{ forloop.counter0 }}" value="{{ r.email }}" /></td>
              <td><input type="text" name="first_name_{{ forloop.counter0 }}" value="{{ r.first_name }}" /></td>
              <td><input type="text" name="last_name_{{ forloop.counter0 }}" value="{{ r.last_name }}" /></td>
              <td><input type="text" name="class_{{ forloop.counter0 }}" value="{{ r.class }}" /></td>
              <td><input type="number" name="attended_{{ forloop.counter0 }}" value="{{ r.attended }}" min="0" /></td>
              <td><input type="number" name="absent_{{ forloop.counter0 }}" value="{{ r.absent }}" min="0" /></td>
              <td><input type="number" name="late_{{ forloop.counter0 }}" value="{{ r.late }}" min="0" /></td>
              <td><input type="text" name="latest_attended_{{ forloop.counter0 }}" value="{{ r.latest_attended }}" /></td>
              <td><input type="text" name="events_attended_{{ forloop.counter0 }}" value="{{ r.events_attended }}" /></td>
            </tr>
            {% empty %}
            <tr><td colspan="9">No historical data yet. Upload one from the home screen.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="button-container" style="margin-top: 16px;">
        <button class="btn btn-primary" type="submit">Save</button>
        <a class="btn btn-secondary" href="{% url 'raffle:upload' %}">Cancel</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}


